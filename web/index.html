<html>
<head>
<title>Hope Badge USB</title>
</head>

<body>

<h1>Next Hope Badge USB Modification</h1>

<p>by Travis Goodspeed &lt;travis at tnbelt.com&gt;,<br />
for use with or without a badge hacking kit distributed by Mitch Altman.</p>

<p>This kit is best used with the 80-pin MSP430F2618 model, so switching to
that model is recommended prior to assembly.</p>

<h2>Introduction</h2>

<p>The following instructions are for adding USB support to a Next
Hope conference badge, model numbers of which are NHB12 and NHB12B.
For further details see my article entitled
<a href="http://travisgoodspeed.blogspot.com/2010/06/hacking-next-hope-badge.html">Hacking
the Next Hope Badge</a>.</p>

<p>While these instructions are not terribly complicated, the kit is
not intended for a first-time solderer.  If you have never soldered
before, then build a TV-B-Gone as practice before having someone help
you assemble this kit.  Additionally, some Unix or command-line Windows
experience is necessary, as the tools involved do not have a GUI.</p>

<h2>Modification</h2>

<p>First, be sure that you have both a mini USB connector and an
FT232RL chip, as pictured below.  This are included in Mitch's
kit.</p>

<p><a href="http://www.flickr.com/photos/travisgoodspeed/4796189835/"
title="Mini USB Connectors by Travis Goodspeed, on
Flickr"><img src="http://farm5.static.flickr.com/4115/4796189835_81d2796af2.jpg"
width="500" height="375" alt="Mini USB Connectors" /></a></p>

<p><a href="http://www.flickr.com/photos/travisgoodspeed/4796190529/"
title="FT232RL Chip by Travis Goodspeed, on
Flickr"><img src="http://farm5.static.flickr.com/4119/4796190529_4b14c2728f.jpg"
width="500" height="375" alt="FT232RL Chip" /></a></p>

<p>Modify your badge by the following steps:</p>
<ul>

<li>(Optional) Use a soldering iron to remove first one side, then the
other, of the battery clip.  If leaving the battery in place, be sure not to
have both a battery and USB power at the same time.</li>

<li>Use a Dremel tool or fine cutters to remove the two plastic nubs
from the the Mini USB plug.  The badges as manufactured lack holes for the
nubs, so it is necessary to remove them for mechanical compatibility.</li>

<li>Fit the Mini USB connector to the board as shown in Appendix A.
It should fit flush with the board, fitting securely after soldering.
Solder a single of the pins first, then a second to ensure proper
positioning.  The side plugs should be soldered last, with plenty of extra
solder for mechanical stability.</li>

<li><b>UNDER NO CIRCUMSTANCES</b> should the board be held by its USB
connector.  If twisted as a level, the connector will come off, and it
will not be fun to repair the board.</p>

<li>Once the USB connector is properly in place, fit the FTDI chip as
shown in Appendix A.  The circle on the chip, which indicates Pin 1,
should be next to the "U3" text.  First, tack a single corner pin of
the chip.  Once this is done and the chip is still positioned
properly, tack a pin on the opposite corner with as little solder as
possible.  Finally, after verifying that those pins are properly
positioned, solder the remaining pins.  If any bridge, remove the
excess solder with a coper soldering wick.</li>

<li>Having these parts connected, plug the badge into your computer
using the included USB A to Mini B cable.  You should then see a new
USB device enumeration.  If anything gets hot, immediately unplug the
badge and check your soldering.</li>

</ul>

<h2>Driver</h2>

The FTDI Virtual Comm Port (VCP) driver for Windows and Mac can be
found
at <a href="http://www.ftdichip.com/Drivers/VCP.htm">http://www.ftdichip.com/Drivers/VCP.htm</a>,
while Linux and OpenBSD distributions generally ship with built-in
support.

<h2>OpenBeacon Firmware</h2>

<p>To reflash your badge's OpenBeacon firmware, grab the NHBadge
project from subversion.  The Unix command for this is ``<i>svn co
https://nhbadge.svn.sourceforge.net/svnroot/nhbadge</i>''.  (TortoiseSVN will
retrieve the same URL for Windows users.)http://tinyurl.com/).  Inside
the <i>nhbadge/dist</i> path, one will find the latest Next Hope badge firmware
along with Windows batch scripts for programming the badges.  Unix users with
a C compiler and GoodFET and instead run ``<i>goodfet.bsl -e -p foo.hex</i>'' to compile the firmware
and flash a firmware image over USB.</p>

<p>To make things a bit easier, a ZIP file distribution for Windows users is available at
<a href="http://goodserv.cis.upenn.edu/nhdist.zip">http://goodserv.cis.upenn.edu/nhdist.zip</a>.
This is the exact file that was sent to the manufacturer, and was the
file used on the production line to program these things.</p>

<h2>GoodFET Firmware</h2>

<p>To download the GoodFET firmware for either Unix or Windows,
visit <a href="http://goodfet.sourceforge.net/">http://goodfet.sf.net/</a> and follow
the SVN instructions.  Once installed, you can flash the GoodFET firmware to the badge with
either 'goodfet.bsl -e -p goodfet2618.hex' or 'GFBSL.EXE -e -p goodfet2618.hex'.
<p>

<p>Once flashed with firmware, the badge will respond to
'goodfet.monitor info' ('GFMON.EXE info' on Windows) with its model
number and clock calibrations.

<h2>Appendix A: Component Placement</h2>


<p><a href="http://www.flickr.com/photos/travisgoodspeed/4796886774/"
title="NHBadge USB by Travis Goodspeed, on
Flickr"><img src="http://farm5.static.flickr.com/4095/4796886774_3da98ef486.jpg"
width="500" height="375" alt="NHBadge USB" /></a></p>

<p><a href="http://www.flickr.com/photos/travisgoodspeed/4796190529/"
title="FT232RL Chip by Travis Goodspeed, on
Flickr"><img src="http://farm5.static.flickr.com/4119/4796190529_4b14c2728f.jpg"
width="500" height="375" alt="FT232RL Chip" /></a></p>


<h2>Appendix B: Schematic</h2>

<p>This is the NHB12 schematic diagram.  For modifications </p>

<p><img src="nhb12a_schem.jpg" /></p>

</body>

</html>
